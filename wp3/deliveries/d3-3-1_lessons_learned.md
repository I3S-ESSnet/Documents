<img align="right" src="../../communication/i3s-logo-1-small.png" alt="I3S logo"/>

# Report on lessons learned
WP 3 has as overall objectives provide a blueprint and implementing the blueprint to be able to establish and build a sandbox environment and test available services in a containerized environment. The environment has been used to perform functional tests of services (see WP 1) and validate their packaging and installation.

From the proposal (B3171-2017-ESSnet-SERV-2 - proposal id: 831733) for WP3 â€“ Build a sandbox and test available services - containerise
* Platform: A blueprint for putting together a technical cloud ready platform for on premise, or in a public cloud. It will also consist of technical components like a container runtime and orchestration like Kubernetes. We will demonstrate the platform on a small on premise server and on a public cloud offering. Including a simple IAM solution. (Identity Access Management)
* Software: Ready to user container images for key parts of the platform. Including messaging capabilities, service mesh and other standard components based on the requirements from WP2.
* Software: Integrated services built for WP2, and demonstrate that they can run on both the on premise server and the public cloud server, setting up the environment with f.ex. Ansible
Playbook.
* Report: Advantages and drawbacks of containerisation. Lessons learnt.

Methods and technologies for containerization has been studied and guidelines (D3.1.1. - Blueprint) and resources (D3.1.2. - Implementing the blueprint) has been delivered. The blueprint document provides an overall description for establishing a runtime environment for implementing modern sharable services following the CSPA standards and principles as containers. Within the document we have described the concepts, guidelines and considerations for providing and developing services, as well describing some considerations related to security and logging. Implementing the blueprint provides examples on implementations using the concept of "Infrastructure as code" as well as how to implement sharable services on these platforms.

In the following sections of this document we will discuss some of the identified challenges related to establishing an environment for implementation of sharable services and give examples of success.

Even though there has been challenges and obstacles in the process we do think that we have met the objectives as described in the project description. The collaboration with WP 1 and WP 2 has been important, both for binding the overall architecture descriptions to the technical architecture description in the blueprint and implementing the blueprint as well as the collaboration (discussions and deployathons) as proof-of-concepts and improvement of the processes to provide a platform for implementing shared services.


## Document and implement blueprint
Documenting and managing architecture in an environment where innovation and technology is constantly changing and evolving challenges the way we describe and document architecture and perform architectural design. From the initiation of the I3S project towards the end of this project we have experienced that defining the "sandbox platform" beforehand would limit the boundaries and innovation for implementing services on the platform. It would also result in an outdated blueprint by the end of the project. However, the overall international concepts, strategies and frameworks for NSIs have been used to describe and document important elements when establishing a cloud platform for shared services. The document is interconnected with the work of WP 2 describing the architectural guidelines and cookbook and the WP 3 deliverable implementation of the blueprint as a proof-of-concept. From the planning of the project to finalize the deliveries the blueprint has to some extent changed in relation to granularity, which means that it does not document and describe technology artefact but focus on technology concepts and strategic approaches to consider.

The implementation of blueprint is a volatile document that serves as a proof-of-concept and guideline for establishing a platform in the cloud and implement shared services. One of the key successes for the deliveries in WP3 has been the collaboration with WP2 related to the blueprint both for agreeing on the content of deliverables but also to interconnect the architectural guidelines with the blueprint. Another success has been the deployathons and hackathons with members from the other work packages, these gatherings had an agile approach with highly skilled members to perform proof-of-concepts of shared services based on the concepts and descriptions in the blueprint.

Our main purpose of implementing the blueprint has been to implement a platform with the capability of establishing shared services. Through the deployathons we have gathered experience and proven the ability to establish shared services on the platform. In this process we have experienced some technical and implementation issues that should be addressed: 

- Containerisation of services and applications - Windows containers
  - Some legacy applications require running on Windows operating system. Docker supports Windows containers so there is not really a problem. But when you give it a try you soon discover how large the containers are. Just building a .NET 4.x application require a 10GB SDK image. The image for running the applicaton inside an IIS (internet information server) is 6.8GB. This means building av deploying windows applicatons take longer time than thypical Linux containers and the lightweight experience you expect with containers are missing. The Windows containers also require Windows host so just running an image to test an application will not work on other operating systems. 
  - We also testet managed Kubernetes on Azure (AKS) in 2020. Kubernetes clusters with  Windows worker nodes are supported but some features are still in preview as of 2021.
- Authentication and authorization of developers has proven as a challenge when using existing user directories setup for other purposes. One need to consider how shared platforms can govern and manage users for access to platform capabilities and collaboration in developing capabilities and shared services. 
- Securing shared services and platforms need to be considered related to concepts and patterns, shared services across NSIs would have implementations using different security concepts and implementations that would have implications for reuse of services and building pipelines of services.  

Implementing the blueprint has been focusing on the technical aspects of establishing the platform and shared services, we have not been able to work on the governance, management and security issues related to establish and manage cloud platforms for sharing services across NSIs. Sharing common platforms across organizations would require the capabilities to govern, manage and secure collaboration platforms for keeping up with the emerging technological change to reduce risks. The implementation of blueprint provides guidelines and examples for NSIs to establish platforms and services for sharing, that would not need to have governance bodies to handle collaboration between national borders.

## Concluding remarks
The established sandbox platforms has proven the sharing of services, as the WP1 and WP3 deliveries have implemented both platforms and services running on the platform. Implmenting the blueprint (D3.1.2) has documented the technology used and the steps to build the platform, containerize and deploying the services. It also include a "Try it yourself" chapter. 

In the I3S the project has implemented a shared sandbox platform that can be used also after the project completed. This would require funding and actions related to governance and management of the platform. There are also some security issues related to authentication and authorization for developers and the management of the platform, as well as further work on security concepts for such a platform. However, the project has proven the ability to share services as containters that can be implemented on platforms governed and managed by the individual NSI. The ESS Expert group could be an arena for sharing experience and advice NSIs in how to build and implement shared statistical services, as well as the CSPA service catalogue could be useful for identifying, sharing and collaborate on developing and use shared services. 

Documenting the blueprint provides the important considerations for establishing shared services and linking this to the Cookbook and Architecture guidelines describing the architecture possibilities for sharing and integrating services. The blueprint document describes and discuss technical capabilities related to providing services, developing services as well as considerations related to security and logging. Altough technologies changes and emerge the concept and considerations described in the blueprint should be relevant and valid over time, as the technical architecture descriptions should be developed and maintained as part of the platform and documentation of the shared services. 

Above all the deliverables in WP 3 has been a collaboration with the members in the other Work Pacakges in I3S, especially for the implementation part of the deliverable the highly skilled technical expertice has proven to be valuable and important for the end result. As earlier mentioned the "deployathons", with an agile approach, where developers meet online and work with the tasks of establishing the platform and implement services has both been an efficient approach and given valuable input to the WP3 deliverables. Even though one would have prefered to meet physically, virtual meetings has some limits and downsides as for example lack of informal discussions, collaboration and discussions around overall sketches and solutions. However, there are upsides as for example you can decide to meet on short notice to discuss and solve problems and challenges.

Statistics Norway was planned to deliver most of the working days to WP3 in addition to working days in WP1, WP2 and WP5. The budget reporting show that it has been a challenge to separate working days especially between WP3 and WP1 as the tasks delivered by Statistics Norway in WP1 is tightly coupled with Implementing the blueprint and collaboration with WP1 resources, especially related to PXWeb. Most of the working days planned delivered on WP1 is reported as WP3 working days even though. For the delivery of the blueprint and the relation to WP2 most of the working days reported by Statistics Norway on WP2 are related to collaboration meetings and discussions of scoping of WP2 and WP3. In our internal economy system our resources is reported on each Work package, and is not broken down in tasks and deliverables. However, a rough "guestimate" would be that approximately 80% of the working days are related to WP3 and collaboration and contributions to WP1 and WP2. The rest of the working days is related to administrative tasks and meetings.
